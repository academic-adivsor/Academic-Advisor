"use strict";require("../config/dbConnect");var private_key=process.env.DIALOGFLOW_PRIVATE_KEY,client_email=process.env.DIALOGFLOW_CLIENT_EMAIL,express=require("express"),bodyParser=require("body-parser"),morgan=require("morgan"),cors=require("cors"),app=express(),_require=require("../middlewares/globalErrHandler"),globalErrHandler=_require.globalErrHandler,notFoundErr=_require.notFoundErr,academicTermRouter=require("../routes/academics/academicTerm"),academicYearRouter=require("../routes/academics/academicYear"),classLevelRouter=require("../routes/academics/classLevel"),programRouter=require("../routes/academics/program"),subjectRouter=require("../routes/academics/subjects"),yearGroupRouter=require("../routes/academics/yearGroups"),adminRouter=require("../routes/staff/adminRouter"),chatRoute=require("../routes/chatRoute");app.use(require("../routes/chatRoute")),app.use(express.json()),app.use("/api/v1/admins",adminRouter),app.use("/api/v1/academic-years",academicYearRouter),app.use("/api/v1/academic-terms",academicTermRouter),app.use("/api/v1/class-levels",classLevelRouter),app.use("/api/v1/programs",programRouter),app.use("/api/v1/subjects",subjectRouter),app.use("/api/v1/year-groups",yearGroupRouter),app.use("/api/v1/chat",chatRoute),app.use(notFoundErr),app.use(globalErrHandler);var whitelist=["http://Admin-Dashboard-localhost:8800","http://Student-Dashboard-main-localhost:8800","http://Doctor_DashBord-localhost:8800","http://localhost:8800"],corsOptions={origin:function(e,r){-1!==whitelist.indexOf(e)?r(null,!0):r(new Error("Not allowed by CORS"))}};app.use(cors(corsOptions));var dialogflow=require("dialogflow"),uuid=require("uuid"),sessionClient=new dialogflow.SessionsClient({credentials:{private_key:private_key,client_email:client_email}}),sessionPath=sessionClient.sessionPath("parker-pslk",uuid.v4()),processUserMessage=function(r){var a,s,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return a={session:sessionPath,queryInput:{text:{text:r,languageCode:"en-US"}}},e.prev=1,e.next=4,regeneratorRuntime.awrap(sessionClient.detectIntent(a));case 4:return s=e.sent,t=s[0].queryResult.fulfillmentText,e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(1),console.error("Error:",e.t0),e.abrupt("return","Oops! Something went wrong. Please try again.");case 13:case"end":return e.stop()}},null,null,[[1,9]])};app.use(bodyParser.urlencoded({extended:!0})),app.use(bodyParser.json()),module.exports=app;
//# sourceMappingURL=app.min.js.map
