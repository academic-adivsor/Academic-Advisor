"use strict";var User=require("../model/user"),_require=require("../utlis/helpers"),hashPassword=_require.hashPassword,comparePassword=_require.comparePassword,jwt=require("jsonwebtoken");exports.logincontroller=function(r,s){var n,t,a,o,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.body,t=n.email,a=n.password,e.next=4,regeneratorRuntime.awrap(User.findOne({email:t}).exec());case 4:if(o=e.sent){e.next=7;break}return e.abrupt("return",s.status(400).send("No user found"));case 7:return e.next=9,regeneratorRuntime.awrap(comparePassword(a,o.password));case 9:e.sent,u=jwt.sign({_id:o._id},process.env.JWT_SECRET,{expiresIn:"7d"}),o.password=void 0,s.cookie("token",u,{httpOnly:!0}),s.json(o),e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",s.status(400).send("Error. Try again."));case 20:case"end":return e.stop()}},null,null,[[0,16]])};
//# sourceMappingURL=auth.min.js.map
