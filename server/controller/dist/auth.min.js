"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.register=void 0;var _user=_interopRequireDefault(require("../models/user")),_auth=require("../utils/auth"),_jsonwebtoken=_interopRequireDefault(require("jsonwebtoken"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var register=function(r,t){var n,a,s,u,i,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=r.body,a=n.name,s=n.email,u=n.password,a){e.next=4;break}return e.abrupt("return",t.status(400).send("Name is required"));case 4:if(!u||u.length<6)return e.abrupt("return",t.status(400).send("Password is required and should be min 6 characters long"));e.next=6;break;case 6:return e.next=8,regeneratorRuntime.awrap(_user.default.findOne({email:s}).exec());case 8:if(e.sent)return e.abrupt("return",t.status(400).send("Email is taken"));e.next=11;break;case 11:return e.next=13,regeneratorRuntime.awrap((0,_auth.hashPassword)(u));case 13:return i=e.sent,o=new _user.default({name:a,email:s,password:i}),e.next=17,regeneratorRuntime.awrap(o.save());case 17:return e.abrupt("return",t.json({ok:!0}));case 20:return e.prev=20,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",t.status(400).send("Error. Try again."));case 24:case"end":return e.stop()}},null,null,[[0,20]])};exports.register=register;
//# sourceMappingURL=auth.min.js.map
