"use strict";var AsyncHandler=require("express-async-handler"),bcrypt=require("bcryptjs"),Admin=require("../../model/staff/Admin"),generateToken=require("../../utlis/generateToken"),verifyToken=require("../../utlis/verifyToken"),_require=require("../../utlis/helpers"),hashPassword=_require.hashPassword,isPassMatched=_require.isPassMatched;exports.registerAdmnCtrl=AsyncHandler(function(t,s){var r,a,n,u,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.body,a=r.name,n=r.email,u=r.password,e.next=3,regeneratorRuntime.awrap(Admin.findOne({email:n}));case 3:if(e.sent)throw new Error("Admin Exists");e.next=6;break;case 6:return e.t0=regeneratorRuntime,e.t1=Admin,e.t2=a,e.t3=n,e.next=12,regeneratorRuntime.awrap(hashPassword(u));case 12:return e.t4=e.sent,e.t5={name:e.t2,email:e.t3,password:e.t4},e.t6=e.t1.create.call(e.t1,e.t5),e.next=17,e.t0.awrap.call(e.t0,e.t6);case 17:i=e.sent,s.status(201).json({status:"success",data:i,message:"Admin registered successfully"});case 19:case"end":return e.stop()}})}),exports.loginAdminCtrl=AsyncHandler(function(t,s){var r,a,n,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.body,a=r.email,n=r.password,e.next=3,regeneratorRuntime.awrap(Admin.findOne({email:a}));case 3:if(u=e.sent){e.next=6;break}return e.abrupt("return",s.json({message:"Invalid login crendentials"}));case 6:return e.next=8,regeneratorRuntime.awrap(isPassMatched(n,u.password));case 8:if(e.sent){e.next=13;break}return e.abrupt("return",s.json({message:"Invalid login crendentials"}));case 13:return e.abrupt("return",s.json({data:generateToken(u._id),message:"Admin Logged in successfully"}));case 14:case"end":return e.stop()}})}),exports.getAdminsCtrl=AsyncHandler(function(e,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Admin.findOne());case 2:s=e.sent,t.status(200).json({status:"success",message:"Admins Fetched successfully",data:s});case 4:case"end":return e.stop()}})}),exports.getAdminProfileCtrl=AsyncHandler(function(t,s){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Admin.findById(t.userAuth._id).select("-password -createdAt -updatedAt").populate("academicYears"));case 2:if(r=e.sent){e.next=7;break}throw new Error("Admin not found");case 7:s.status(200).json({status:"success",data:r,message:"Admin Profile Fetched successfully"});case 8:case"end":return e.stop()}})}),exports.updateAdminCtrl=AsyncHandler(function(t,s){var r,a,n,u,i,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.body,a=r.email,n=r.name,u=r.password,e.next=3,regeneratorRuntime.awrap(Admin.findOne({email:a}));case 3:if(e.sent)throw new Error("This email is taken/exist");e.next=6;break;case 6:if(u)return e.t0=regeneratorRuntime,e.t1=Admin,e.t2=t.userAuth._id,e.t3=a,e.next=13,regeneratorRuntime.awrap(hashPassword(u));e.next=24;break;case 13:return e.t4=e.sent,e.t5=n,e.t6={email:e.t3,password:e.t4,name:e.t5},e.t7={new:!0,runValidators:!0},e.t8=e.t1.findByIdAndUpdate.call(e.t1,e.t2,e.t6,e.t7),e.next=20,e.t0.awrap.call(e.t0,e.t8);case 20:i=e.sent,s.status(200).json({status:"success",data:i,message:"Admin updated successfully"}),e.next=28;break;case 24:return e.next=26,regeneratorRuntime.awrap(Admin.findByIdAndUpdate(t.userAuth._id,{email:a,name:n},{new:!0,runValidators:!0}));case 26:c=e.sent,s.status(200).json({status:"success",data:c,message:"Admin updated successfully"});case 28:case"end":return e.stop()}})}),exports.deleteAdminCtrl=function(e,t){try{t.status(201).json({status:"success",data:"delete admin"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminSuspendTeacherCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin suspend teacher"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminUnSuspendTeacherCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin unsuspend teacher"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminWithdrawTeacherCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin withdraw teacher"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminUnWithdrawTeacherCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin unwithdraw teacher"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminPublishResultsCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin publish exam results"})}catch(e){t.json({status:"failed",error:e.message})}},exports.adminUnPublishResultsCtrl=function(e,t){try{t.status(201).json({status:"success",data:"admin unpublish exam results"})}catch(e){t.json({status:"failed",error:e.message})}};
//# sourceMappingURL=adminCtrl.min.js.map
