{"version":3,"sources":["server.js"],"names":["require","config","mongoose","express","bodyParser","uuid","server","http","createServer","app","dialogflow","PORT","connect","process","env","MONGO_URL","useNewUrlParser","useUnifiedTopology","sessionClient","SessionsClient","credentials","port","DIALOGFLOW_CLIENT_EMAIL","sessionPath","v4","urlencoded","extended","private_key","adminRouter","academicTermRouter","classLevelRouter","use","yearGroupRouter","academicYearRouter","subjectRouter","chatRoute","next","res","status","json","message","req","console","error","listen","log"],"mappings":"aAAAA,QAAQ,UAAUC,SAAlBD,IAAAA,QAAOA,QAAP,WAGME,SAAWF,QAAQ,YADnBG,KAAOH,QAAU,QAGjBI,WAAaJ,QAAQ,eAFrBE,WAAWF,QAAQ,cAInBK,KAAOL,QAAQ,QAHrBA,QAAU,qBAAVA,GACA,IAAMI,IAAAA,UAMAE,OAASC,KAAKC,aAAaC,KAL3BC,KAAAA,QAAaV,IAAQW,MAAA,IAS3BT,SAASU,QAAQC,QAAQC,IAAIC,UAAW,CAAEC,iBAAiB,EAAMC,oBAAoB,IAGrF,IAAMC,cAAgB,IAAIR,WAAWS,eAAe,CARpDC,YAAYjB,CACNG,YAAaO,QAACL,IAAAA,uBACda,aAAcR,QAAKF,IAAZW,2BAKbC,YAAAL,cAAAK,YAAA,cAAAlB,KAAAmB,MAEEJ,IAAAA,IAAAA,WAAaK,WAAA,CAAAC,UAAA,KACXC,IAAAA,IAAAA,WAAad,QAFmC,IAOpDe,YAAA5B,QAAA,8BASM6B,mBAAqB7B,QAAQ,mCAR7BuB,mBAAcL,QAAcK,mCAU5BO,iBAAmB9B,QAAQ,iCAP7B+B,cAAeN,QAAW,8BAAEC,cAAU1B,QAAA,+BAA1CgC,gBAAAhC,QAAA,iCACI+B,UAAc/B,QAAlB,sBAGAS,IAAMmB,IAAAA,iBAAsBA,aAU5BnB,IAAIsB,IAAI,yBAA0BE,oBATlCxB,IAAMoB,IAAAA,yBAA6BA,oBAWnCpB,IAAIsB,IAAI,uBAAwBD,kBAVhCrB,IAAMwB,IAAAA,mBAAqBjC,eAY3BS,IAAIsB,IAAI,mBAAoBG,eAX5BzB,IAAMqB,IAAAA,sBAA2BE,iBAajCvB,IAAIsB,IAAI,eAAgBI,WAXxB1B,IAAMyB,IAAAA,SAAAA,EAAAA,EAAaE,GAejBC,EAAIC,OAAO,KAAKC,KAAK,CAAEC,QAAS,gBAblC/B,IAAM0B,IAAAA,SAAAA,EAASM,EAAGzC,EAAQoC,GAiBxBM,QAAQC,MAAM,SAAUA,OAf1BlC,EAAIsB,OAAI,KAAAQ,KAAA,CAARC,QAA0BZ,4BAI1BnB,OAAAmC,OAAQvB,KAAA,WACRZ,QAAQoC,IAARpC,6BAAAA,OAAAY","file":"server.min.js","sourcesContent":["require(\"dotenv\").config(); \r\n\r\nconst express = require(\"express\");\r\nconst mongoose = require('mongoose');\r\nconst http = require('http');\r\nconst bodyParser = require('body-parser');\r\nconst dialogflow = require('dialogflow');\r\nconst uuid = require('uuid');\r\nrequire(\"./config/dbConnect\")(); // This will call the function and attempt to connect to the database.\r\n\r\nconst app = express();\r\nconst server = http.createServer(app);\r\nconst port = process.env.PORT || 8000;\r\n\r\n// Connect to MongoDB\r\nmongoose.connect(process.env.MONGO_URL, { useNewUrlParser: true, useUnifiedTopology: true });\r\n\r\n// Initialize session client\r\nconst sessionClient = new dialogflow.SessionsClient({\r\n  credentials: {\r\n    private_key: process.env.DIALOGFLOW_PRIVATE_KEY,\r\n    client_email: process.env.DIALOGFLOW_CLIENT_EMAIL\r\n  }\r\n});\r\n\r\n// Generate session path\r\nconst sessionPath = sessionClient.sessionPath('parker-pslk', uuid.v4());\r\n\r\n// Middlewares\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\n// Load routes (if they are in separate files)\r\nconst adminRouter = require(\"./routes/staff/adminRouter\");\r\nconst academicTermRouter = require(\"./routes/academics/academicTerm\");\r\nconst academicYearRouter = require(\"./routes/academics/academicYear\");\r\nconst classLevelRouter = require(\"./routes/academics/classLevel\");\r\nconst programRouter = require(\"./routes/academics/program\");\r\nconst subjectRouter = require(\"./routes/academics/subjects\");\r\nconst yearGroupRouter = require(\"./routes/academics/yearGroups\");\r\nconst chatRoute = require(\"./routes/chatRoute\");\r\n\r\napp.use(\"/api/v1/admins\", adminRouter);\r\napp.use(\"/api/v1/academic-years\", academicYearRouter);\r\napp.use(\"/api/v1/academic-terms\", academicTermRouter);\r\napp.use(\"/api/v1/class-levels\", classLevelRouter);\r\napp.use(\"/api/v1/programs\", programRouter);\r\napp.use(\"/api/v1/subjects\", subjectRouter);\r\napp.use(\"/api/v1/year-groups\", yearGroupRouter);\r\napp.use(\"/api/v1/chat\", chatRoute);\r\n\r\n// Error middlewares\r\napp.use((req, res, next) => {\r\n  res.status(404).json({ message: 'Not Found' });\r\n});\r\n\r\napp.use((err, req, res, next) => {\r\n  console.error('Error:', error);\r\n  res.status(500).json({ message: 'Internal Server Error' });\r\n});\r\n\r\n// Start server\r\nserver.listen(port, () => {\r\n  console.log(`Server is running on port ${port}`);\r\n});"]}